---
import type { GetStaticPaths } from 'astro'
import Layout from '../layouts/Layout.astro'
import { DinoStartScreen } from '../components/DinoStartScreen'
import { dinos } from '@/data/siteData'

export const prerender = false

// Extract dino param from the URL path
const { dino } = Astro.params
export const getStaticPaths = (() => {
    return dinos.map((dino) => ({
        params: { dino: dino.id.toLocaleLowerCase() },
    }))
}) satisfies GetStaticPaths

const matchingDino =
    dinos.find((dinoToMatch) => dinoToMatch.id.toLocaleLowerCase() === dino) ??
    dinos[0]

// Check if we should animate based on referrer, otherwise it doesn't make much sense
const referer = Astro.request.headers.get('referer') || ''
console.log('referer', referer)
const shouldAnimate = referer.includes('/select') || referer.endsWith('/select')
---

<Layout title={`Welcome ${matchingDino?.name ?? ''}`}>
    <DinoStartScreen
        client:only="react"
        {...matchingDino}
        shouldAnimate={shouldAnimate}
    />
</Layout>
